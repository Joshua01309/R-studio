"0",""
"0","# Resumen de las columnas 13 a 16"
"0","Heating %>% select(13:16) %>% summary()"
"1",""
"1","     income     "
"1","     agehed     "
"1","     rooms      "
"1","    region   "
"1","
"
"1"," Min.   :2.000  "
"1"," Min.   :20.00  "
"1"," Min.   :2.000  "
"1"," valley:177  "
"1","
"
"1"," 1st Qu.:3.000  "
"1"," 1st Qu.:30.00  "
"1"," 1st Qu.:3.000  "
"1"," scostl:361  "
"1","
"
"1"," Median :5.000  "
"1"," Median :45.00  "
"1"," Median :4.000  "
"1"," mountn:102  "
"1","
"
"1"," Mean   :4.641  "
"1"," Mean   :42.94  "
"1"," Mean   :4.424  "
"1"," ncostl:260  "
"1","
"
"1"," 3rd Qu.:6.000  "
"1"," 3rd Qu.:55.00  "
"1"," 3rd Qu.:6.000  "
"1","             "
"1","
"
"1"," Max.   :7.000  "
"1"," Max.   :65.00  "
"1"," Max.   :7.000  "
"1","             "
"1","
"
"0","# Convertir dataset a formato mlogit"
"0","H <- Heating %>% mlogit.data(shape = ""wide"", choice=""depvar"", varying=c(3:12))"
"0",""
"0","# Ajuste de modelo mlogit con model3"
"0","model3 <- mlogit(depvar ~ ic + oc, Heating, shape = ""wide"", choice = ""depvar"", reflevel = ""ec"", varying = c(3:12))"
"0",""
"0","summary(model3)"
"1","
Call:
"
"1","mlogit(formula = depvar ~ ic + oc, data = Heating, reflevel = ""ec"", 
"
"1","    shape = ""wide"", choice = ""depvar"", varying = c(3:12), method = ""nr"")
"
"1","
"
"1","Frequencies of alternatives:"
"1","choice
"
"1","      ec "
"1","      er "
"1","      gc "
"1","      gr "
"1","      hp "
"1","
"
"1","0.071111 "
"1","0.093333 "
"1","0.636667 "
"1","0.143333 "
"1","0.055556 "
"1","
"
"1","
"
"1","nr method
"
"1","6 iterations, 0h:0m:0s 
"
"1","g'(-H)^-1g = 9.58E-06 
"
"1","successive function values within tolerance limits 
"
"1","
Coefficients :
"
"1","              "
"1","    Estimate"
"1","  Std. Error"
"1"," z-value"
"1","  Pr(>|z|)"
"1","    "
"1","
(Intercept):er"
"1","  0.19459102"
"1","  0.20424212"
"1","  0.9527"
"1"," 0.3407184"
"1","    "
"1","
(Intercept):gc"
"1","  0.05213336"
"1","  0.46598878"
"1","  0.1119"
"1"," 0.9109210"
"1","    "
"1","
(Intercept):gr"
"1"," -1.35058266"
"1","  0.50715442"
"1"," -2.6631"
"1"," 0.0077434"
"1"," ** "
"1","
(Intercept):hp"
"1"," -1.65884594"
"1","  0.44841936"
"1"," -3.6993"
"1"," 0.0002162"
"1"," ***"
"1","
ic            "
"1"," -0.00153315"
"1","  0.00062086"
"1"," -2.4694"
"1"," 0.0135333"
"1"," *  "
"1","
oc            "
"1"," -0.00699637"
"1","  0.00155408"
"1"," -4.5019"
"1"," 6.734e-06"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
"
"1","Log-Likelihood: -1008.2
"
"1","McFadden R^2: "
"1"," "
"1","0.013691"
"1"," "
"1","
"
"1","Likelihood ratio test : "
"1",""
"1","chisq"
"1",""
"1"," = "
"1",""
"1","27.99"
"1",""
"1"," (p.value = "
"1",""
"1","8.3572e-07"
"1",""
"1",")
"
"0","# Definición de parámetros para la función de distribución logística"
"0","mu <- 0"
"0","sigma <- 1"
"0",""
"0","# Creación de dataframe para la función logística"
"0","df <- tibble(x=seq(from=-6+mu, to=6+mu, by=0.01 ), "
"0","             f=plogis(x, location=mu, scale=sigma))"
"0",""
"0","# Cálculo de mínimos, medios y máximos costos de instalación y operación"
"0","min_cost <- Heating %>%"
"0","  select(starts_with(""ic""), starts_with(""oc"")) %>%"
"0","  summarise(across(.cols = everything(), min))"
"0",""
"0","mean_cost <- Heating %>%"
"0","  select(starts_with(""ic""), starts_with(""oc"")) %>%"
"0","  summarise(across(.cols = everything(), mean))"
"0",""
"0","max_cost <- Heating %>%"
"0","  select(starts_with(""ic""), starts_with(""oc"")) %>%"
"0","  summarise(across(.cols = everything(), max))"
"0",""
"0",""
"0","# Creación de datasets para mínimos, medios y máximos costos de instalación"
"0","ic_min <- ic_mean <- ic_max <- Heating[1, ]"
"0","oc_min<- oc_mean <- oc_max <- Heating[1, ]"
"0",""
"0","ic_min[3:12] <- min_cost"
"0","ic_mean[3:12] <- mean_cost"
"0","ic_max[3:12] <- max_cost"
"0",""
"0","oc_min[3:12] <- min_cost"
"0","oc_mean[3:12] <- mean_cost"
"0","oc_max[3:12] <- max_cost"
"0",""
"0","# Predicciones para mínimos, medios y máximos costos de instalación"
"0","p_model3_ic_min <- predict(model3, newdata = mlogit.data(ic_min, shape = ""wide"", choice = ""depvar"", varying = 3:12))"
"0","p_model3_ic_mean <- predict(model3, newdata = mlogit.data(ic_mean, shape = ""wide"", choice = ""depvar"", varying = 3:12))"
"0","p_model3_ic_max <- predict(model3, newdata = mlogit.data(ic_max, shape = ""wide"", choice = ""depvar"", varying = 3:12))"
"0",""
"0","p_model3_oc_min <- predict(model3, newdata = mlogit.data(oc_min, shape = ""wide"", choice = ""depvar"", varying = 3:12))"
"0","p_model3_oc_mean <- predict(model3, newdata = mlogit.data(oc_mean, shape = ""wide"", choice = ""depvar"", varying = 3:12))"
"0","p_model3_oc_max <- predict(model3, newdata = mlogit.data(oc_max, shape = ""wide"", choice = ""depvar"", varying = 3:12))"
"0",""
"0","# Visualización de resultados"
"0","data.frame(System = c(""Electric Central"", ""Electric Room"", ""Gas Central"", ""Gas Room"", ""Heat Pump""),"
"0","           ic_min = ic_min %>% select(ic.ec, ic.er, ic.gc, ic.gr, ic.hp) %>% t() %>% as.numeric() %>%"
"0","                    round(1),"
"0","           p_min = p_model3_ic_min %>% as.numeric() %>% round(3),"
"0","           ic_mean = ic_mean %>% select(ic.ec, ic.er, ic.gc, ic.gr, ic.hp) %>% t() %>% as.numeric() %>%"
"0","                     round(1),"
"0","          p_mean = p_model3_ic_mean %>% as.numeric() %>% round(3),"
"0","          ic_max = ic_max %>% select(ic.ec, ic.er, ic.gc, ic.gr, ic.hp) %>% t() %>% as.numeric() %>%"
"0","                   round(1),"
"0","          p_max = p_model3_ic_max %>% as.numeric() %>% round(3)) %>%"
"0","          kable(col.names = c(""System"", ""Cost"", ""Probability"", ""Cost"", ""Probability"", ""Cost"", ""Probability""),"
"0","          digits = 3) %>% kable_styling() %>% "
"0","          add_header_above(c("" "" = 1, ""Minimum Cost"" = 2, ""Mean Cost"" = 2, ""Maximum Cost"" = 2))"
