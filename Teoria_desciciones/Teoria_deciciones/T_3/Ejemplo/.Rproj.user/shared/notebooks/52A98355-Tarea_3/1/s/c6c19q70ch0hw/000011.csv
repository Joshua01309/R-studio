"0","f <- function(x) {cos(x)+sin(x)}"
"0","df <- function(x) {-sin(x)+cos(x)}"
"0",""
"0","x_0 <- 0"
"0","x_n <- 2"
"0","nn <- c(4,5,10,20)"
"0",""
"0","my_colors <- brewer.pal(n=length(nn)+1, name=""Pastel2"")"
"0","names(my_colors)<-c(""f(x)"", paste(""S"", nn, sep=""_""))"
"0",""
"0","for (n in nn){"
"0","  x_nodes<-seq(x_0, x_n, length.out=n)"
"0","f_nodes<-f(x_nodes)"
"0","my_spline<-cubicspline(x_nodes, f_nodes, endp2nd = TRUE, der=c(df(x_0), df(x_n)))"
"0","my_spline_function<-function(x){ppval(my_spline,x)}"
"0",""
"0","grafica<-ggplot()+"
"0","  geom_function(aes(color=""f(x)""), fun=f, linewidth=1.50)+"
"0","  geom_function(aes(color=paste(""S"", n, sep=""_"")), fun=my_spline_function,linewidth=0.65, inherit.aes = TRUE)+"
"0","  geom_point(aes(x_nodes, f_nodes), size=3, color=""blue"")+"
"0","  xlim(x_0, x_n)+"
"0","  scale_color_manual(values=my_colors)+"
"0","    labs(x=""x"", y=""y"", color=""funcion"")+"
"0","    theme_bw()"
"0","  print(grafica)"
"0","}"
"0",""
