"0","dy <- function(t,y){"
"0","  y-t^2+1"
"0","}"
"0","y_sol <- function(t){"
"0","  -exp(t)/2+(t+1)^2"
"0","}"
"0",""
"0","my_euler <- function(dy, a,b, N, y0){"
"0","  h <- (b-a)/N"
"0","  T <- a"
"0","  W <- y0"
"0","  for (k in 1:N) {"
"0","    w_new <- W[k]+ h*dy(T[k], W[k])"
"0","    T <- c(T, T[k]+h)"
"0","    W <- c(W, w_new)"
"0","  }"
"0","  resultados <- list(""T""=T, ""W""=W)"
"0","  return(resultados)"
"0","}"
"0",""
"0","# h <- 0.5 "
"0","# T <- 0"
"0","# W <- 0.5"
"0","# t1 <- 0+h"
"0","# w1 <- 0.5+h*dy(0, 0.5)"
"0","# T <- c(T, t1)"
"0","# W <- c(W,w1)"
"0","# "
"0","# t2 <- t1+h"
"0","# w2 <- w1+h*dy(t1, w1)"
"0","# T <- c(T, t2)"
"0","# W <- c(W,w2)"
"0","# "
"0","# t3 <- t2+h"
"0","# w3 <- w2+h*dy(t2, w2)"
"0","# T <- c(T, t3)"
"0","# W <- c(W,w3)"
"0","# "
"0","# "
"0","# t4 <- t3+h"
"0","# w4 <- w3+h*dy(t3, w3)"
"0","# T <- c(T, t4)"
"0","# W <- c(W,w4)"
"0",""
"0","sol_aprox <- my_euler(dy, 0, 2, 100, 0.5)"
"0",""
"0",""
"0","my_colors=c(""y(x)""=""firebrick"", ""w(x)""=""dodgerblue"")"
"0",""
"0","ggplot()+"
"0","  geom_function(aes(color=""y(x)""),fun=y_sol, xlim=c(0,2))+"
"0","  geom_line(aes(sol_aprox$T,sol_aprox$W, color=""w(x)""))+"
"0","  #geom_point(aes(sol_aprox$T,sol_aprox$W), color=""green"", size=3)+"
"0","  scale_color_manual(values=my_colors)+"
"0","  labs(x=""t"", y=""y(t)"", color="" "")+"
"0","  theme_bw()"
"0",""
